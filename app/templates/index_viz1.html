<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Visualiseur audio â€” Spectre centrÃ© + vidÃ©o + voiture</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">
  
  <!-- Butterchurn Libraries - Essai avec JSDelivr CDN -->
  <script src="https://cdn.jsdelivr.net/npm/butterchurn@2.6.7/lib/butterchurn.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/butterchurn-presets@2.4.7/lib/butterchurnPresets.min.js"></script>
  
  <!-- Test si Butterchurn est chargÃ© -->
  <script>
    window.addEventListener('load', () => {
      console.log('Page chargÃ©e - Test Butterchurn:');
      console.log('window.butterchurn:', window.butterchurn);
      console.log('window.butterchurnPresets:', window.butterchurnPresets);
      if (window.butterchurn) {
        console.log('Butterchurn disponible! MÃ©thodes:', Object.keys(window.butterchurn));
      } else {
        console.error('Butterchurn NON disponible!');
      }
    });
  </script>
</head>
<body>
  <!-- ========== Ã‰CRAN D'UPLOAD ========== -->
  <div id="uploadScreen">
    <h1>ğŸµ Visualiseur Audio Interactif</h1>
    <div id="dropZone">
      <div class="icon">ğŸ¶</div>
      <div class="text">Glisse ton fichier audio ici</div>
      <div class="subtext">ou clique pour choisir un fichier</div>
    </div>
    <button class="upload-btn" id="uploadBtn">Choisir un fichier</button>
    <input id="fileInput" type="file" accept="audio/*" style="display:none">
  </div>

  <!-- ========== Ã‰CRAN VISUALISEUR ========== -->
  <div class="wrap">
    <!-- ContrÃ´les flottants -->
    <div class="floating-controls">
      <button id="playBtn" class="control-btn">â–¶</button>
      <button id="backBtn" class="control-btn">â† Retour</button>
      <button id="nextPreset" class="control-btn">ğŸ¨ Style</button>
      <button id="toggleBg" class="control-btn">ğŸ‘ï¸ Fond</button>
    </div>

    <!-- Timer flottant -->
    <div class="floating-timer" id="timer">0:00 / 0:00</div>

    <!-- Section info (debug) -->
    <div class="floating-section-info" id="sectionInfo" style="display:none">
      <span id="sectionType">-</span>
    </div>

    <div class="canvas-container">
      <canvas id="canvas"></canvas>
    </div>
  </div>

  <!-- Hidden video & audio elements used as sources -->
  <video id="bgVideo" style="display:none" muted loop playsinline crossorigin="anonymous"></video>
  <audio id="audioEl" style="display:none" crossorigin="anonymous"></audio>

  <script type="module" src="{{ url_for('static', filename='js/main.js') }}"></script>
</body>
</html>
